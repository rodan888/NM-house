$(function(){var t={opt:{body:$("body"),header:$("header"),mobButton:$(".mob-button"),sideNav:$(".side-nav"),searchButton:$(".search-button"),tabs:$(".tabs"),ajaxButton:$(".load-more"),ajaxArhive:$(".nav-ajax button"),asideBun:$(".attachment"),popup:$(".btn.pop"),popupSlider:$(".popup-slider"),popupPortfolio:$(".popup-portfolio"),menuDrop:$(".level-two"),footToggle:$("#foot-toggle"),filter:$(".filter"),nav:$("nav"),img:$("img"),linc:$("a"),wind:$(window),gridAjax:$(".grid.ajax"),grid:$(".grid"),gridFirst:$(".grid.gallery.first"),gridSecond:$(".grid.gallery.second"),packeryOptions:{itemSelector:".card-grid",gutter:4},packeryOptionsI:{itemSelector:".grid-item",gutter:14},slider:$(".slider"),slideSidebar:$(".slider-sidebar"),sliderBottom:$(".slider-bottom"),sliderFour:$(".slider-four"),sliderTwo:$(".slider-two"),owlTest:function(t,i,o){var a=function(){this.navigation=!0,this.slideSpeed=300,this.autoPlay=3e3,this.navigation=!0,this.autoPlay=!1,this.autoHeight=o,this.pagination=!0,this.scrollPerPage=!0,this.singleItem=t,this.items=i,this.itemsDesktop=[1199,2],this.itemsDesktopSmall=[991,2],this.navigationText=['<i class="fa fa-angle-left"></i>','<i class="fa fa-angle-right"></i>']};return new a}},docScroll:function(t,i){var o=t.offset().top,a=t.height(),e=this.opt.header.height();$(window).on("scroll",function(){var s=$(this).scrollTop(),n=i.offset().top,r=s-(o-e),l=n-(a-e);r>0&&r<l-s&&t.css("top",r+"px")})},scroolTo:function(i,o){var a=t.opt.header.height();$(i).on("click",function(){$("body, html").animate({scrollTop:$(o).offset().top-a},1e3)})},ajaxJournal:function(){this.opt.ajaxArhive.on("click",function(){var i=$(this).data("ajax"),o=$(this).data("parrent"),a=$(this).data("filter"),e=$(this).data("limit"),s=$(this).data("tpl");t.opt.ajaxArhive.removeClass("active"),$(this).addClass("active"),t.opt.grid.children().detach(),$(".ajax-wrap .preloader").fadeIn("fast"),a?$.get(i+"?parent="+o+"&filter="+a,function(i){$(".ajax-wrap .preloader").fadeOut("fast"),t.opt.grid.append(i).packery("reloadItems").packery("layout")}):$("#housefilter").length?$.get(i+"?parent="+o+"&tpl="+s+"&limit="+e,function(i){$(".ajax-wrap .preloader").fadeOut("fast");var o=$.parseHTML(i),a=o.length,e=[],s=[];console.log("Good");for(var n=0;n<a;n++)n<6?e.push(o[n]):s.push(o[n]);t.opt.gridSecond.append(s).packery("reloadItems").packery("layout"),t.opt.gridFirst.append(e).packery("reloadItems").packery("layout"),t.insertCustom()}):$.get(i+"?parent="+o+"&tpl="+s+"&limit="+e,function(i){$(".ajax-wrap .preloader").fadeOut("fast"),t.opt.grid.append(i).packery("reloadItems").packery("layout")})})},ajaxPackery:function(){var i=this.opt.ajaxButton,o=i.data("start"),a=i.data("count");o>=a&&i.detach(),i.on("click",function(){$(this).addClass("load");var i=$(this).data("ajax"),a=$(this).data("count"),e=$(this).data("parent"),s=$(this).data("tpl"),n=$(this).data("offset"),r=$(this).data("append");$.get(i+"?offset="+o+"&parent="+e+"&limit="+n+"&tpl="+s,function(i){r?$("."+r).append(i):t.opt.gridAjax.append(i).packery("reloadItems").packery("layout")}),o+=n,o>=a?$(this).detach():$(this).removeClass("load")})},dropDownMenu:function(){t.toggleC(t.opt.mobButton);var i=t.opt.sideNav.find(".level-one");i.on("click",function(){i.not($(this)).find(".level-two").slideUp("slow"),$(this).find(".level-two").slideToggle("slow")}),t.opt.mobButton.on("click",function(){$(this).hasClass("active")?($(document).keydown(function(i){if(27===i.keyCode)return t.opt.mobButton.click(),!1}),$("main").css("margin-left","250px").addClass("ohidden"),t.opt.body.addClass("ohidden"),t.opt.sideNav.addClass("active").css({height:$(window).height()-$(".navbar").height()+"px",left:"0px"})):(t.opt.body.removeClass("ohidden"),t.opt.sideNav.removeClass("active").css("left","-250px"),$("main").css("margin-left","0px").removeClass("ohidden"))})},popupSlider:function(t){t.each(function(){$(this).magnificPopup({delegate:"a",type:"image",gallery:{enabled:!0}})})},packeryFilter:function(){var i,o=$(".packery-nav li"),a=$(".card-grid");o.on("click",function(){i=$(this).data("filter"),a.fadeOut("fast"),$("."+i).fadeIn("fast",function(){$(this).addClass("card-grid"),t.opt.grid.packery(t.opt.packeryOptionsI)})})},formatMenu:function(){this.opt.nav.find(">ul li").mouseover(function(){var i=$(this).find(t.opt.menuDrop),o=i.find("ul"),a=o.width(),e=o.length;i.width(a*e+20*(e-1)+"px"),t.opt.nav.find(">ul li").not($(this)).removeClass("active"),$(this).toggleClass("active")}).mouseout(function(){t.opt.nav.find(">ul li").removeClass("active")})},formSearch:function(){var i=$("#searchForm"),o=t.opt.wind.width();this.opt.searchButton.on("click",function(){i.toggleClass("active"),i.hasClass("active")?o>768?i.width(t.navWidth()):i.width(o-65+"px"):i.width(0)})},navWidth:function(){return this.opt.nav.width()},tabs:function(t){var i,o=t.find(".tab-link"),a=t.find(".tab");o.on("click",function(){i=$(this).data("show"),o.removeClass("active"),$(this).addClass("active"),a.css("display","none").find(".tab-content").removeClass("active"),$("#"+i).fadeIn(600).find(".tab-content").addClass("active")})},popup:function(t){t.on("click",function(t){t.preventDefault();var i=$(this).data("show"),o=$("#"+i);o.fadeIn(600).css("height",$(window).height()+"px").find(".popup-content").removeClass("anim").append('<span class="fade_out">&#9587;</span>'),$(".fade_out,.popup-close").click(function(){o.fadeOut(600).find(".popup-content").addClass("anim"),$(".fade_out").detach()})})},owlThumb:function(){function t(t){var o=this.currentItem;$(".owlThumb2").find(".owl-item").removeClass("synced").eq(o).addClass("synced"),void 0!==$(".owlThumb2").data("owlCarousel")&&i(o)}function i(t){var i=a.data("owlCarousel").owl.visibleItems,o=t,e=!1;for(var s in i)if(o===i[s])var e=!0;e===!1?o>i[i.length-1]?a.trigger("owl.goTo",o-i.length+2):(o-1===-1&&(o=0),a.trigger("owl.goTo",o)):o===i[i.length-1]?a.trigger("owl.goTo",i[1]):o===i[0]&&a.trigger("owl.goTo",o-1)}var o=$(".owlThumb1"),a=$(".owlThumb2");o.owlCarousel({singleItem:!0,slideSpeed:1e3,navigation:!0,pagination:!1,afterAction:t,responsiveRefreshRate:200}),a.owlCarousel({items:8,itemsDesktop:[1199,8],itemsDesktopSmall:[979,8],itemsTablet:[768,6],itemsMobile:[479,4],pagination:!1,responsiveRefreshRate:100,afterInit:function(t){t.find(".owl-item").eq(0).addClass("synced")}}),$(".owlThumb2").on("click",".owl-item",function(t){t.preventDefault();var i=$(this).data("owlItem");o.trigger("owl.goTo",i)})},footToggle:function(){var t=this.opt.footToggle.parent(".logo-wrap");this.opt.footToggle.on("click",function(){$(this).find("i").toggleClass("fa-caret-down fa-caret-up"),t.next().slideToggle("fast")})},toggleC:function(t){t.on("click",function(){t.not($(this)).removeClass("active"),$(this).toggleClass("active")})},winH:function(){return this.opt.wind.height()},fullHeight:function(t){$(t).css("min-height",this.winH()+"px")},dragstart:function(t){$(t).on("dragstart",function(t){t.preventDefault()})},insertCustom:function(){var i=t.opt.gridFirst.find(".card-grid");if($("#housefilter").length){$('<div class="decor card-grid hover"><div class="img-block"><img src="design/img/house-k.jpg" alt="дом под ключ"><div class="title-wrap"><a href="proektyi-domov/dom-pod-klyuch/" class="tag white">Раздел</a><h3><a href="proektyi-domov/dom-pod-klyuch/">Дом под ключ</a></h3><a href="proektyi-domov/dom-pod-klyuch/" class="read-more"><i class="fa fa-long-arrow-right"></i></a></div></div></div>').insertAfter(i.eq(1));var o='<div class="card-grid pinBun"><div class="img-block"><img src="design/img/pinBun.jpg" alt="foto"></div><div class="title-wrap"><a href="" class="tag defoult">Реклама</a><h3><a href="#">Девять цветов от Farrow &amp; Ball</a></h3><a href="#" class="read-more"><i class="fa fa-long-arrow-right"></i></a></div></div><div class="decor card-grid hover"><div class="img-block"><img src="design/img/house-p.jpg" alt="проектирование"><div class="title-wrap"><a href="proektyi-domov/individualnoe-proektirovanie/" class="tag white">Раздел</a><h3><a href="proektyi-domov/individualnoe-proektirovanie/">Индивидуальное проектирование</a></h3><a href="proektyi-domov/individualnoe-proektirovanie/" class="read-more"><i class="fa fa-long-arrow-right"></i></a></div></div></div>';t.opt.gridFirst.append(o).packery("reloadItems").packery("layout")}},init:function(){this.dragstart(this.opt.img),this.dragstart(this.opt.linc),this.tabs($("#tabs1")),this.tabs($("#tabs2")),this.tabs($("#tabs3")),this.tabs($("#tabs4")),this.opt.slider.owlCarousel(t.opt.owlTest(!0,1,!1)),this.opt.slideSidebar.owlCarousel(t.opt.owlTest(!0,1,!1)),this.opt.sliderBottom.owlCarousel(t.opt.owlTest(!1,3,!1)),this.opt.sliderFour.owlCarousel(t.opt.owlTest(!1,4,!1)),this.owlThumb(),this.opt.sliderTwo.owlCarousel(t.opt.owlTest(!1,2,!0)),this.dropDownMenu(),this.popup(this.opt.popup),this.fullHeight(this.opt.body),this.toggleC(this.opt.filter),this.toggleC(this.opt.searchButton),this.formSearch(),this.footToggle(),this.opt.grid.packery(),this.packeryFilter(),this.popupSlider(this.opt.popupSlider),this.popupSlider(this.opt.popupPortfolio),this.opt.asideBun.length&&this.opt.wind.width()>992&&this.docScroll(this.opt.asideBun,$(".team-block")),this.scroolTo(".btn.register","section.feedbeck"),this.scroolTo(".btn.scr","section.form"),this.scroolTo(".scrl-btn","section.advantages"),this.ajaxPackery(),this.ajaxJournal(),$(window).on("load",function(){t.insertCustom(),t.formatMenu()})}};$("form.send").submit(function(){var t=$(this);return $.ajax({type:"POST",url:this.action,data:t.serialize()}).done(function(){t.hasClass("subscribe")?setTimeout(function(){$(".fade_out").click(),alert("Спасибо! Вы подписаны на новости NM HOUSE")},3e3):alert("Спасибо за заявку!"),setTimeout(function(){t.trigger("reset")},1e3)}),!1}),$(document).ready(function(){function i(){var t=$("body").height();$(".content-b").each(function(i){$(this).innerHeight()<=t&&$(this).closest(".fullscreen").addClass("not-overflow")})}function o(){var t=$(window).height();$(".paralbackground").each(function(i){var o=$(this),a=o.width(),e=o.height(),s=o.attr("data-img-width"),n=o.attr("data-img-height"),r=s/n,l=parseFloat(o.attr("data-diff"));l=l?l:0;var d=0;o.hasClass("parallax")&&!$("html").hasClass("touch")&&(d=t-e),n=e+d+l,s=n*r,a>s&&(s=a,n=s/r),o.data("resized-imgW",s),o.data("resized-imgH",n),o.css("background-size",s+"px "+n+"px")})}function a(t){var i=$(window).height(),o=$(window).scrollTop(),a=o+i,e=(o+a)/2;$(".parallax").each(function(t){var s=$(this),n=s.height(),r=s.offset().top,l=r+n;if(a>r&&l>o){var d=(s.data("resized-imgW"),s.data("resized-imgH")),c=0,h=-d+i,p=i>n?d-n:d-i;r-=p,l+=p;var u=c+(h-c)*(e-r)/(l-r),f=s.attr("data-oriz-pos");f=f?f:"50%",$(this).css("background-position",f+" "+u+"px")}})}t.init(),"ontouchstart"in window&&(document.documentElement.className=document.documentElement.className+" touch"),$("html").hasClass("touch")||$(".parallax").css("background-attachment","fixed"),$(window).resize(i),i(),$(window).resize(o),$(window).focus(o),o(),$("html").hasClass("touch")||($(window).resize(a),$(window).scroll(a),a());try{$.browserSelector(),$("html").hasClass("chrome")&&$.smoothScroll()}catch(t){}})});